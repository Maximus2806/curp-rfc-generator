<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>CURP & RFC Generator</title>
<style>
  body { font-family: Arial, sans-serif; max-width: 500px; margin: 20px auto; }
  label { display: block; margin-top: 10px; }
  input, select, button { width: 100%; padding: 6px; margin-top: 4px; }
  .result { margin-top: 20px; font-weight: bold; }
</style>
</head>
<body>

<h2>CURP & RFC Generator</h2>

<label>First Name: <input type="text" id="firstName"></label>
<label>Last Name 1: <input type="text" id="lastName1"></label>
<label>Last Name 2: <input type="text" id="lastName2"></label>
<label>Birth Date: <input type="date" id="birthDate"></label>
<label>Gender:
  <select id="gender">
    <option value="H">Male</option>
    <option value="M">Female</option>
  </select>
</label>
<label>State:
  <select id="stateCode">
    <option value="DF">Ciudad de México</option>
    <option value="AS">Aguascalientes</option>
    <option value="BC">Baja California</option>
    <option value="BS">Baja California Sur</option>
    <option value="CC">Campeche</option>
    <option value="CL">Coahuila</option>
    <option value="CM">Colima</option>
    <option value="CS">Chiapas</option>
    <option value="CH">Chihuahua</option>
    <option value="DG">Durango</option>
    <option value="GT">Guanajuato</option>
    <option value="GR">Guerrero</option>
    <option value="HG">Hidalgo</option>
    <option value="JC">Jalisco</option>
    <option value="MC">México</option>
    <option value="MN">Michoacán</option>
    <option value="MS">Morelos</option>
    <option value="NT">Nayarit</option>
    <option value="NL">Nuevo León</option>
    <option value="OC">Oaxaca</option>
    <option value="PL">Puebla</option>
    <option value="QT">Querétaro</option>
    <option value="QR">Quintana Roo</option>
    <option value="SP">San Luis Potosí</option>
    <option value="SL">Sinaloa</option>
    <option value="SR">Sonora</option>
    <option value="TC">Tabasco</option>
    <option value="TS">Tamaulipas</option>
    <option value="TL">Tlaxcala</option>
    <option value="VZ">Veracruz</option>
    <option value="YN">Yucatán</option>
    <option value="ZS">Zacatecas</option>
    <option value="NE">Nacido en el Extranjero</option>
  </select>
</label>

<button onclick="generate()">Generate</button>

<div class="result" id="result"></div>

<script>
// === JS из предыдущей версии вставляем сюда ===
function cleanString(str) {
  return str.normalize("NFD").replace(/[\u0300-\u036f]/g, "").toUpperCase().replace(/[^A-Z]/g, "");
}
function firstInternalVowel(str) {
  const match = str.slice(1).match(/[AEIOU]/);
  return match ? match[0] : 'X';
}
function firstInternalConsonant(str) {
  const match = str.slice(1).match(/[BCDFGHJKLMNÑPQRSTVWXYZ]/);
  return match ? match[0] : 'X';
}
const mexicanStates = {AS:"Aguascalientes",BC:"Baja California",BS:"Baja California Sur",CC:"Campeche",CL:"Coahuila",CM:"Colima",CS:"Chiapas",CH:"Chihuahua",DF:"Ciudad de México",DG:"Durango",GT:"Guanajuato",GR:"Guerrero",HG:"Hidalgo",JC:"Jalisco",MC:"México",MN:"Michoacán",MS:"Morelos",NT:"Nayarit",NL:"Nuevo León",OC:"Oaxaca",PL:"Puebla",QT:"Querétaro",QR:"Quintana Roo",SP:"San Luis Potosí",SL:"Sinaloa",SR:"Sonora",TC:"Tabasco",TS:"Tamaulipas",TL:"Tlaxcala",VZ:"Veracruz",YN:"Yucatán",ZS:"Zacatecas",NE:"Nacido en el Extranjero"};
function getValidStateCode(code) {
  const upperCode = code.toUpperCase();
  return mexicanStates[upperCode] ? upperCode : "NE";
}
function generateCURP(firstName, lastName1, lastName2, birthDate, gender, stateCode) {
  lastName1 = cleanString(lastName1);
  lastName2 = cleanString(lastName2);
  firstName = cleanString(firstName);
  const year = birthDate.getFullYear();
  const yy = String(year).slice(-2);
  const mm = String(birthDate.getMonth() + 1).padStart(2, '0');
  const dd = String(birthDate.getDate()).padStart(2, '0');
  const part1 = lastName1[0] + firstInternalVowel(lastName1) + (lastName2[0] || 'X') + (firstName[0] || 'X');
  const part2 = yy + mm + dd + gender.toUpperCase() + getValidStateCode(stateCode);
  const part3 = firstInternalConsonant(lastName1) + firstInternalConsonant(lastName2) + firstInternalConsonant(firstName);
  const part4 = Math.floor(Math.random() * 100).toString().padStart(2, '0');
  return (part1 + part2 + part3 + part4).toUpperCase();
}
function generateRFC(firstName, lastName1, lastName2, birthDate) {
  lastName1 = cleanString(lastName1);
  lastName2 = cleanString(lastName2);
  firstName = cleanString(firstName);
  const year = birthDate.getFullYear();
  const yy = String(year).slice(-2);
  const mm = String(birthDate.getMonth() + 1).padStart(2, '0');
  const dd = String(birthDate.getDate()).padStart(2, '0');
  const part1 = lastName1[0] + firstInternalVowel(lastName1) + (lastName2[0] || 'X') + (firstName[0] || 'X');
  const part2 = yy + mm + dd;
  const homoclave = Array.from({ length: 3 }, () => String.fromCharCode(65 + Math.floor(Math.random() * 26))).join('');
  return (part1 + part2 + homoclave).toUpperCase();
}
function generate() {
  const firstName = document.getElementById("firstName").value;
  const lastName1 = document.getElementById("lastName1").value;
  const lastName2 = document.getElementById("lastName2").value;
  const birthDate = new Date(document.getElementById("birthDate").value);
  const gender = document.getElementById("gender").value;
  const stateCode = document.getElementById("stateCode").value;
  
  if (!firstName || !lastName1 || !birthDate.getTime()) {
    document.getElementById("result").textContent = "Please fill all required fields.";
    return;
  }
  
  const curp = generateCURP(firstName, lastName1, lastName2, birthDate, gender, stateCode);
  const rfc = generateRFC(firstName, lastName1, lastName2, birthDate);
  
  document.getElementById("result").innerHTML = `CURP: ${curp}<br>RFC: ${rfc}`;
}
</script>
</body>
</html>
